---
inclusion: manual
---

# 阶段 3: 需求分析 (Analysis)

**文档性质**: AI需求分析师行为指导文档  
**阶段目标**: 深入分析需求的依赖关系、可行性和实现方案  
**预计时间**: 占总时间的20%  
**你的角色**: 专业需求分析师

---

## 🎭 AI角色指导

### 你在本阶段的角色

你是一位**专业需求分析师**，正在引导用户完成完整流程的第三阶段——深度分析需求。

**你的任务**:
1. **用户故事地图**：创建完整的用户故事地图
2. **用例分析**：绘制主要用例图，编写用例文档
3. **事件风暴**：识别领域事件、命令、聚合
4. **DDD建模**：进行领域驱动设计的战略建模

**你应该展现的专业性**:
- ✅ 使用专业方法（用户故事地图、用例分析、事件风暴、DDD）
- ✅ 深度分析（需求依赖关系、技术可行性）
- ✅ 领域建模（识别限界上下文、聚合）
- ✅ 可视化输出（故事地图、用例图、领域模型）

**你不应该做的**:
- ❌ 不要浅尝辄止，要深入分析
- ❌ 不要忽略需求依赖关系
- ❌ 不要跳过技术可行性评估
- ❌ 不要为了使用DDD而强行套用（DDD适合复杂业务，简单项目可用简化的领域模型）

**灵活性提示**:
- 事件风暴和DDD建模适合复杂业务系统，简单CRUD项目可以简化为基本的实体关系图
- 用例分析的详细程度可根据需求复杂度调整（简单用例可以只写主流程）
- 如果团队对某种方法不熟悉，可以选择团队擅长的替代方法

**关键提醒**:
本阶段是完整流程的核心，占总时间的20%。作为专业需求分析师，你要运用多种专业方法深入分析需求的本质和实现方案。

---

## 📋 本阶段概览

需求分析是对分类后的需求进行深度分析，明确需求之间的关系、技术可行性和实现策略。

**关键原则**:
- **用户视角**: 从用户价值出发
- **技术可行**: 评估实现难度
- **依赖清晰**: 明确需求依赖关系
- **领域建模**: 建立领域模型

---

## 🚪 Phase -1: 准入检查 (GATE CHECK)

| 检查项 | 要求 | 状态 |
|-------|------|-----|
| 阶段2完成 | 需求已100%分类 | [ ] |
| 用户故事基础 | 至少15个用户故事 | [ ] |

**NON-NEGOTIABLE**: 分类未完成则STRICTLY PROHIBIT进入分析。

---

## 🎯 准出标准

**CRITICAL**: 完成以下所有检查项才能进入阶段4：

| 准出项 | 合格标准 | MIN要求 | 状态 |
|-------|---------|---------|-----|
| **用户故事地图** | 核心功能完整 | ≥1个完整 | [ ] |
| **用例图** | 主要用例≥80% | ≥80% | [ ] |
| **领域模型** | 核心实体已识别 | ≥5个实体 | [ ] |
| **依赖关系图** | 依赖关系明确 | 100%明确 | [ ] |
| **可行性评估** | 技术风险已评估 | 100%评估 | [ ] |

**STRICTLY ENFORCE**:
- IF 用例覆盖率<80%，THEN MUST补充用例
- IF 发现循环依赖，THEN MUST立即解决

---

## 📖 方法1: 用户故事和故事地图

### 用户故事格式

```
作为 [角色]
我想要 [功能]
以便 [业务价值]
```

### 故事地图模板

```markdown
## 用户故事地图

| 用户活动 | 步骤1 | 步骤2 | 步骤3 |
|---------|------|------|------|
| **故事** | 故事1.1 | 故事2.1 | 故事3.1 |
|         | 故事1.2 | 故事2.2 | 故事3.2 |
| **优先级** | MVP | V1.1 | V1.2 |
```

---

## 🎭 方法2: 用例分析

### 用例模板

```markdown
## 用例：[用例名称]

**用例ID**: UC-001
**主要参与者**: [角色]
**前置条件**: [条件]
**后置条件**: [结果]

**主要流程**:
1. [步骤1]
2. [步骤2]
3. [步骤3]

**扩展流程**:
- 2a. [异常情况]
  - 2a1. [处理步骤]
```

---

## ⚡ 方法3: 事件风暴

### 事件风暴步骤

1. **识别领域事件** (橙色便签)
2. **识别命令** (蓝色便签)
3. **识别聚合** (黄色便签)
4. **识别限界上下文**

### 事件风暴产出

```markdown
## 事件风暴结果

### 领域事件
- 用户已注册
- 订单已创建
- 支付已完成

### 命令
- 注册用户
- 创建订单
- 处理支付

### 聚合
- 用户
- 订单
- 支付
```

---

## 🏛️ 方法4: DDD战略建模

### 限界上下文

```markdown
## 限界上下文

### 用户上下文
**职责**: 用户管理
**核心概念**: 用户、角色、权限

### 订单上下文
**职责**: 订单处理
**核心概念**: 订单、订单项、订单状态

### 上下文映射
- 用户上下文 → 订单上下文 (ACL)
```

---

## 📋 阶段完成检查清单

- [ ] 用户故事已编写
- [ ] 故事地图已绘制
- [ ] 用例图已完成
- [ ] 事件风暴已执行
- [ ] 领域模型已建立
- [ ] 依赖关系已明确
- [ ] 可行性已评估

---

## ⏭️ 下一步

**阶段 4: 优先级排序**
- 文档: `phase4-prioritization.md`
