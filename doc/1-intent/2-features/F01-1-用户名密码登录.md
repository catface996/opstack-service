# F01-1: 用户名密码登录

## 基本信息

- **Feature ID**: F01-1
- **Feature 名称**: 用户名密码登录
- **优先级**: P0（MVP 必须）
- **状态**: 待开发
- **负责人**: 待分配
- **预计工作量**: 待评估

## 用户故事

作为用户，我希望能够使用用户名和密码登录系统，以便访问和使用系统功能。

## 功能价值

- 提供基础的身份认证方式
- 保障系统安全
- 支持独立部署场景

## 核心功能

### 1. 用户名密码登录
- 用户名密码输入和验证
- 密码加密存储（BCrypt）
- 登录失败次数限制
- 账号锁定机制

### 2. 账号安全
- 密码强度要求
- 密码加密存储
- 登录失败记录
- 自动锁定和解锁

## 验收标准

### AC1: 用户名密码登录
**WHEN** 用户输入正确的用户名和密码 **THEN** THE System **SHALL** 允许用户登录并跳转到首页

**WHEN** 用户输入错误的密码 **THEN** THE System **SHALL** 显示错误提示并记录失败次数

**WHEN** 用户输入不存在的用户名 **THEN** THE System **SHALL** 显示通用错误提示（不泄露用户是否存在）

### AC2: 账号锁定机制
**WHEN** 用户连续 5 次输入错误密码 **THEN** THE System **SHALL** 锁定账号 30 分钟

**WHEN** 账号被锁定期间用户尝试登录 **THEN** THE System **SHALL** 显示账号锁定提示和剩余时间

**WHEN** 锁定时间到期 **THEN** THE System **SHALL** 自动解锁账号

### AC3: 密码安全
**WHEN** 用户密码存储 **THEN** THE System **SHALL** 使用 BCrypt 加密算法

**WHEN** 用户登录 **THEN** THE System **SHALL** 使用 HTTPS 传输

**WHEN** 用户登录失败 **THEN** THE System **SHALL** 记录审计日志

## 依赖关系

### 前置依赖
- 无

### 后置依赖
- F01-4: 会话管理
- F11: 管理资源的访问权限
- 所有其他需要登录的 Feature

## 技术考虑

### 认证框架
- Spring Security
- BCrypt 密码加密
- 登录失败计数器（Redis/内存）

### 安全措施
- 密码加密（BCrypt）
- HTTPS 传输
- CSRF 防护
- XSS 防护
- SQL 注入防护
- 时序攻击防护

### 数据存储
- 用户账号信息（数据库）
- 登录失败记录（Redis/缓存）
- 审计日志（数据库）

## 界面设计要点

### 登录页面
- 用户名输入框
- 密码输入框（带显示/隐藏切换）
- 登录按钮
- 错误提示区域
- 忘记密码链接（可选）

### 错误提示
- 用户名或密码错误
- 账号已锁定（显示剩余时间）
- 网络错误提示

## 测试要点

### 功能测试
- 测试正确用户名密码登录
- 测试错误密码登录
- 测试不存在的用户名
- 测试账号锁定机制
- 测试锁定自动解除

### 安全测试
- 测试密码加密存储
- 测试 SQL 注入防护
- 测试暴力破解防护
- 测试时序攻击防护
- 测试 CSRF 防护

### 性能测试
- 测试并发登录
- 测试密码验证性能

## 相关文档

- 需求文档: `doc/intent/blueprint.md` - 2.6.1 多种身份认证方式
- Feature List: `doc/intent/feature-list.md`

---

**创建日期**: 2024-11-23  
**最后更新**: 2024-11-23  
**文档版本**: v1.0
